(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{484:function(s,t,a){"use strict";a.r(t);var n=a(8),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("create date: 2023-12-10 20:39"),t("br"),s._v("\nStatus: #idea"),t("br"),s._v("\nTags: [[嵌入式]]")]),s._v(" "),t("hr"),s._v(" "),t("h1",{attrs:{id:"寄存器级的开发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#寄存器级的开发"}},[s._v("#")]),s._v(" 寄存器级的开发")]),s._v(" "),t("h2",{attrs:{id:"什么是寄存器编程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是寄存器编程"}},[s._v("#")]),s._v(" 什么是寄存器编程")]),s._v(" "),t("p",[t("strong",[s._v("芯片的组成")]),s._v("：由内核（cpu）与核外外设组成，ARM公司进行内核的设计，ST/TI/NXP组合上特定的外设形成一个单片机。\n"),t("strong",[s._v("总线：")]),s._v(" 多根并行的线，各根线之间传输特定的数据，进行控制、数据传输、寻址等操作；")]),s._v(" "),t("ul",[t("li",[s._v("连接了内核与外设，stm32f4有8条主控总线，7条被控总线\n"),t("img",{attrs:{src:"https://pic-1312640559.cos.ap-chengdu.myqcloud.com//img/20231014134542.png",alt:"image.png"}})])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pic-1312640559.cos.ap-chengdu.myqcloud.com//img/20231014134558.png",alt:"image.png"}}),s._v("\n各种解释：\nccm:在嵌入式系统使用的一个类似高速缓存的东西，靠近cpu的内存，具有低延迟、高带宽的特性，与cpu核心直接耦合。")]),s._v(" "),t("ul",[t("li",[s._v("内核总线 I总线、D总线、S总线分别连接flash、flash/sram、sram/fsmc/ahb，传输指令、数据以及与外设通信")]),s._v(" "),t("li",[s._v("在通用x86架构的计算机中，总线是可以分为地址总线、数据总线以及控制总线的，这些也称为系统总线\n在stm32中对外设的工作方式的配置需要用到寄存器，例如使GPIO口输出高电平：")])]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("（"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x4002")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1414")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFF")]),s._v("；"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//其中的的地址是输出数据寄存器的地址")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("使用别名，也就是寄存器映射的方式：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOF_BASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x40021414")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOF_ODR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("（GPIOF_BASE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x14")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\nGPIOF_ODR "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("根据外设速度对不同，选用不同的四条总线相应总线的最低地址也就是基地址：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("总线名称")]),s._v(" "),t("th",[s._v("总线基地址")]),s._v(" "),t("th",[s._v("相对外设基地址的偏移")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("APB1")]),s._v(" "),t("td",[s._v("0x4000 0000")]),s._v(" "),t("td",[s._v("0x0")])]),s._v(" "),t("tr",[t("td",[s._v("APB2")]),s._v(" "),t("td",[s._v("0x4001 0000")]),s._v(" "),t("td",[s._v("0x0001 0000")])]),s._v(" "),t("tr",[t("td",[s._v("AHB1")]),s._v(" "),t("td",[s._v("0x4002 0000")]),s._v(" "),t("td",[s._v("0x0001 0000")])]),s._v(" "),t("tr",[t("td",[s._v("AHB2")]),s._v(" "),t("td",[s._v("0x5000 0000")]),s._v(" "),t("td",[s._v("0x0001 0000")])]),s._v(" "),t("tr",[t("td",[s._v("AHB1")]),s._v(" "),t("td",[s._v("0x6000 0000")]),s._v(" "),t("td",[s._v("已不属于片上外设")])])])]),s._v(" "),t("p",[s._v("与之类似的，外设也有外设基地址，其为特定外设的首个地址，以GPIO基地址为例：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("外设名称")]),s._v(" "),t("th",[s._v("外设基地址")]),s._v(" "),t("th",[s._v("相对AHB1总线的地址偏移")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("GPIOA")]),s._v(" "),t("td",[s._v("0x4002 0000")]),s._v(" "),t("td",[s._v("0x0")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOB")]),s._v(" "),t("td",[s._v("0x4002 0400")]),s._v(" "),t("td",[s._v("0x0000 0400")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOC")]),s._v(" "),t("td",[s._v("0x4002 0800")]),s._v(" "),t("td",[s._v("0x0000 0800")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOD")]),s._v(" "),t("td",[s._v("0x4002 0C00")]),s._v(" "),t("td",[s._v("0x0000 0C00")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOE")]),s._v(" "),t("td",[s._v("0x4002 1000")]),s._v(" "),t("td",[s._v("0x0000 1000")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF")]),s._v(" "),t("td",[s._v("0x4002 1400")]),s._v(" "),t("td",[s._v("0x0000 1400")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOG")]),s._v(" "),t("td",[s._v("0x4002 1800")]),s._v(" "),t("td",[s._v("0x0000 1800")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOH")]),s._v(" "),t("td",[s._v("0x4002 1C00")]),s._v(" "),t("td",[s._v("0x0000 1C00")])])])]),s._v(" "),t("p",[s._v("外设的地址范围类分部的就是外设的寄存器，GPIOF外设的各种寄存器地址如下：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("寄存器名称")]),s._v(" "),t("th",[s._v("寄存器地址")]),s._v(" "),t("th",[s._v("相对GPIOB基址的偏移")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("GPIOF_MODER")]),s._v(" "),t("td",[s._v("0x4002 1400")]),s._v(" "),t("td",[s._v("0x00")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_OTYPER")]),s._v(" "),t("td",[s._v("0x4002 1404")]),s._v(" "),t("td",[s._v("0x04")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_OSPEEDR")]),s._v(" "),t("td",[s._v("0x4002 1408")]),s._v(" "),t("td",[s._v("0x08")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_PUPDR")]),s._v(" "),t("td",[s._v("0x4002 140C")]),s._v(" "),t("td",[s._v("0x0C")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_IDR")]),s._v(" "),t("td",[s._v("0x4002 1410")]),s._v(" "),t("td",[s._v("0x10")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_ODR")]),s._v(" "),t("td",[s._v("0x4002 1414")]),s._v(" "),t("td",[s._v("0x14")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_BSRR")]),s._v(" "),t("td",[s._v("0x4002 1418")]),s._v(" "),t("td",[s._v("0x18")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_LCKR")]),s._v(" "),t("td",[s._v("0x4002 141C")]),s._v(" "),t("td",[s._v("0x1C")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_AFRL")]),s._v(" "),t("td",[s._v("0x4002 1420")]),s._v(" "),t("td",[s._v("0x20")])]),s._v(" "),t("tr",[t("td",[s._v("GPIOF_AFRH")]),s._v(" "),t("td",[s._v("0x4002 1424")]),s._v(" "),t("td",[s._v("0x24")])])])]),s._v(" "),t("p",[s._v("对于外设的寄存器说明需要参考《STM32F4xx参考手册》中具体章节的寄存器描述部分。")]),s._v(" "),t("h3",{attrs:{id:"使用结构体对gpio进行封装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用结构体对gpio进行封装"}},[s._v("#")]),s._v(" 使用结构体对GPIO进行封装")]),s._v(" "),t("p",[s._v("为了避免重复定义相似的基地址，如不同GPIO口，引入了结构体进行封装：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typedef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typedef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("short")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint16_t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* GPIO寄存器列表 */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("typedef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" MODER"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO模式寄存器             地址偏移: 0x00      */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" OTYPER"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO输出类型寄存器          地址偏移: 0x04      */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" OSPEEDR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO输出速度寄存器          地址偏移: 0x08      */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" PUPDR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO上拉/下拉寄存器         地址偏移: 0x0C      */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" IDR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO输入数据寄存器          地址偏移: 0x10      */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" ODR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO输出数据寄存器          地址偏移: 0x14      */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint16_t")]),s._v(" BSRRL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO置位/复位寄存器低16位部分 地址偏移: 0x18     */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint16_t")]),s._v(" BSRRH"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO置位/复位寄存器高16位部分 地址偏移: 0x1A     */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" LCKR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO配置锁定寄存器          地址偏移: 0x1C      */")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" AFR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*GPIO复用功能配置寄存器       地址偏移: 0x20-0x24  */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" GPIO_TypeDef"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("注：[[C语言]] 结构体内变量的存储空间是连续的，其中32位的变量占用4个字节，16位的变量占用2个字节。这样，只需要定义外设的基地址，对应的寄存器的地址也会因为结构体的特性而自动对应上。")]),s._v(" "),t("div",{staticClass:"language-C line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*使用GPIO_TypeDef把地址强制转换成指针*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOA")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOA_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOB")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOB_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOC")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOC_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOD")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOD_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOE")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOE_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOF")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOF_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOG")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOG_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("GPIOH")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("GPIO_TypeDef "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GPIOH_BASE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")])])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*使用定义好的宏直接访问*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*访问GPIOF端口的寄存器*/")]),s._v("\nGPIOF"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("BSRRL "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//通过指针访问并修改GPIOF_BSRRL寄存器")]),s._v("\nGPIOF"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("MODER "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFFFFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//修改GPIOF_MODER寄存器")]),s._v("\nGPIOF"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("OTYPER "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFFFFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//修改GPIOF_OTYPER寄存器")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("uint32_t")]),s._v(" temp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ntemp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" GPIOF"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("IDR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//读取GPIOF_IDR寄存器的值到变量temp中")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*访问GPIOA端口的寄存器*/")]),s._v("\nGPIOA"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("BSRRL "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//通过指针访问并修改GPIOA_BSRRL寄存器")]),s._v("\nGPIOA"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("MODER "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFFFFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//修改GPIOA_MODER寄存器")]),s._v("\nGPIOA"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("OTYPER "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xFFFFFFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//修改GPIOA_OTYPER寄存器")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//uint32_t temp;     //该变量前面已定义")]),s._v("\ntemp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" GPIOA"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("IDR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//读取GPIOA_IDR寄存器的值到变量temp中")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("修改寄存器的位操作方法：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//对 bit2 清零")]),s._v("\n a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 对某几位进行赋值 */")]),s._v("\n\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//假设 a = 1000 0011 b")]),s._v("\n a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//此时对清零后的第2组bit4、bit5设置成二进制数“01 b ”（也就是“01 b”左移4位）")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//即 a = 1001 0011 b，成功设置了第2组的值，其它组不变")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h1",{attrs:{id:"references"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[s._v("#")]),s._v(" references")]),s._v(" "),t("p",[s._v("野火的教程")])])}),[],!1,null,null,null);t.default=e.exports}}]);