---
title: 循迹小车实验指导书
date: 2023-12-19 15:02:44
permalink: /pages/e1eda4/
sidebar: auto
categories:
  - zk
tags:
  - 
author: 
  name: asafield
  link: https://github.com/Asafield
---
create date: 2022-12-11 19:29
modify date: 2022-12-19 14:18
Status: #notes #project
Tags: [[单片机]] [[循迹]]    

---
## 实验目的
1. 熟悉软件的使用
2. 熟悉嵌入式开发与FPGA开发的不同
3. 理解循迹小车的软硬件实现原理
4. 实物复现并验证两种方式来实现循迹小车
## 实验内容
1. 利用51单片机作为控制器实现循迹小车：
   元器件 ：
	- 使用控制板芯片：STC89C52
	- 其它：
		- 电源：1.5V干电池 4节
		- L298N电机驱动板 1个
		- 红外循迹模块
		- 直流电机 两个
		- 小车底板、轮子、铜柱、镙母 若干
   要求：
	- 在白色或浅色地面上贴黑色胶带，胶带宽度贴 3cm，最后小车能够沿着所贴的胶带轨迹行进。
2. 利用FPGA开发板作为控制器实现循迹小车：
   元器件：
	- 使用控制板芯片：CycloneII EP2C5T144
	- 其它：
		- 电源：1.5V干电池 4节
		- L298N电机驱动板 1个
		- 红外循迹模块
		- 直流电机 两个
		- 小车底板、轮子、铜柱、镙母 若干
   要求：
	- 在白色或浅色地面上贴黑色胶带，胶带宽度贴 3cm，最后小车能够沿着所贴的胶带轨迹行进。
## 实验原理
### 总体结构
![|700](https://pic-1312640559.cos.ap-chengdu.myqcloud.com/img20221211163200.png)

小车的结构如上图所示，除开供电模块外主要由红外循迹模块、主控模块、电机驱动模块、两个直流电机与对应的左右轮组成。主要的工作流程如下：
- 红外循迹模块能够对模块下方的黑线进行检测，将检测结果返回给主控
- 主控根据结果判断是否向左或右偏离了黑线，根据不同的情况，向L298N驱动模块输出不同的控制信号与PWM信号。
- L298N电机驱动模块根据控制信号来决定驱动直流电机的电压的正负，根据PWM的占空比来控制电压的大小。
- 电压的正负决定了轮子旋转的方向，PWM的占空比决定了轮子的转速
经过了以上的流程，就实现了根据红外循迹模块的数据来控制左右轮转向与转速的效果。下面对红外循迹模块与L298N驱动模块的原理与使用方式进行介绍。
### 红外循迹模块
![](https://pic-1312640559.cos.ap-chengdu.myqcloud.com/img20221211165246.png)
循迹传感器的型号为TCRT5000，具体的参数大家可能在网上查询数据手册得到。
**原理：** 传感器的红外发射二极管不断发射红外线，当发射出的红外线没有被反射回来或被反射回来但强度不够大时，红外接收管一直处于关断状态，此时模块的输出端为高电平，指示二极管一直处于熄灭状态；被检测物体出现在检测范围内时，红外线被反射回来且强度足够大，红外接收管饱和，此时模块的输出端为低电平，指示二极管被点亮。
### L298N电机驱动模块
![](https://pic-1312640559.cos.ap-chengdu.myqcloud.com/img20221211174148.png)
该电机驱动模块本质上是一个双H桥电路，其具体的工作原理可能参考这篇文章：
[【电机驱动芯片（H桥、直流电机驱动方式）——DRV8833、TB6612、A4950、L298N的详解与比较】](https://blog.csdn.net/qq_44897194/article/details/105524808)
本次实验我们主要关注模块的使用方式：

| ENA | IN1 | IN2 | 左电机 | ENB | IN3 | IN4 | 右电机 |
| --- | --- | --- | ------ | --- | --- | --- | ------ |
| 0   | x   | x   | 停止   | 0   | x   | x   | 停止   |
| 1   | 0   | 0   | 停止   | 1   | 0   | 0   | 停止   |
| 1   | 1   | 0   | 正转   | 1   | 1   | 0   | 反转   |
| 1   | 0   | 1   | 反转   | 1   | 0   | 1   | 正转   |
| 1   | 1   | 1   | 停止   | 1   | 1   | 1   | 停止       |

注：上表的情况对应了实际接线情况为：

| 左电机黑线 | 左电机红线 | 右电机黑线 | 右电机红线 |
| ---------- | ---------- | ---------- | ---------- |
| OUT1       | OUT2       | OUT3       | OUT4           |

第一个表描述了如何控制电机的方向，也即是通过控制`IN1`、`IN2`、`IN3`、`IN4`来实现。而对速度的控制则是通过`PWM`波对`ENA`与`ENB`进行控制，`PWM`的占空比对应了电机的转速。对于`PWM`的解释可能参考下面这篇文章：
[理解PWM](https://zhuanlan.zhihu.com/p/374083276)
经过上面的描述，我们对循迹小车的结构和大致原理有了一个大致，下面，分别用两种主控（51单片机与FPGA）来进行循迹小车的软硬件设计。

